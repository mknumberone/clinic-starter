{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { create } from 'zustand';\nimport { secureStorage } from \"../lib/secure-storage\";\nexport var useAuthStore = create(function (set) {\n  return {\n    user: null,\n    token: null,\n    isAuthenticated: false,\n    isLoading: true,\n    login: function () {\n      var _login = _asyncToGenerator(function* (token, user) {\n        yield secureStorage.setItem('access_token', token);\n        yield secureStorage.setItem('user', JSON.stringify(user));\n        set({\n          token: token,\n          user: user,\n          isAuthenticated: true\n        });\n      });\n      function login(_x, _x2) {\n        return _login.apply(this, arguments);\n      }\n      return login;\n    }(),\n    logout: function () {\n      var _logout = _asyncToGenerator(function* () {\n        yield secureStorage.deleteItem('access_token');\n        yield secureStorage.deleteItem('user');\n        set({\n          token: null,\n          user: null,\n          isAuthenticated: false\n        });\n      });\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n      return logout;\n    }(),\n    loadAuthData: function () {\n      var _loadAuthData = _asyncToGenerator(function* () {\n        try {\n          var token = yield secureStorage.getItem('access_token');\n          var userStr = yield secureStorage.getItem('user');\n          if (token && userStr) {\n            var user = JSON.parse(userStr);\n            set({\n              token: token,\n              user: user,\n              isAuthenticated: true,\n              isLoading: false\n            });\n          } else {\n            set({\n              isLoading: false\n            });\n          }\n        } catch (error) {\n          console.error('Error loading auth data:', error);\n          set({\n            isLoading: false\n          });\n        }\n      });\n      function loadAuthData() {\n        return _loadAuthData.apply(this, arguments);\n      }\n      return loadAuthData;\n    }()\n  };\n});","map":{"version":3,"names":["create","secureStorage","useAuthStore","set","user","token","isAuthenticated","isLoading","login","_login","_asyncToGenerator","setItem","JSON","stringify","_x","_x2","apply","arguments","logout","_logout","deleteItem","loadAuthData","_loadAuthData","getItem","userStr","parse","error","console"],"sources":["D:/Student/N4_HK2/Web_App/clinic-starter/mobile/src/stores/authStore.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { secureStorage } from '../lib/secure-storage';\r\n\r\nexport interface User {\r\n  id: string;\r\n  phone: string;\r\n  full_name: string;\r\n  email?: string;\r\n  role: 'PATIENT' | 'DOCTOR' | 'ADMIN';\r\n}\r\n\r\ninterface AuthState {\r\n  user: User | null;\r\n  token: string | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  login: (token: string, user: User) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n  loadAuthData: () => Promise<void>;\r\n}\r\n\r\nexport const useAuthStore = create<AuthState>((set) => ({\r\n  user: null,\r\n  token: null,\r\n  isAuthenticated: false,\r\n  isLoading: true,\r\n\r\n  login: async (token, user) => {\r\n    await secureStorage.setItem('access_token', token);\r\n    await secureStorage.setItem('user', JSON.stringify(user));\r\n    set({ token, user, isAuthenticated: true });\r\n  },\r\n\r\n  logout: async () => {\r\n    await secureStorage.deleteItem('access_token');\r\n    await secureStorage.deleteItem('user');\r\n    set({ token: null, user: null, isAuthenticated: false });\r\n  },\r\n\r\n  loadAuthData: async () => {\r\n    try {\r\n      const token = await secureStorage.getItem('access_token');\r\n      const userStr = await secureStorage.getItem('user');\r\n      \r\n      if (token && userStr) {\r\n        const user = JSON.parse(userStr);\r\n        set({ token, user, isAuthenticated: true, isLoading: false });\r\n      } else {\r\n        set({ isLoading: false });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading auth data:', error);\r\n      set({ isLoading: false });\r\n    }\r\n  },\r\n}));\r\n"],"mappings":";AAAA,SAASA,MAAM,QAAQ,SAAS;AAChC,SAASC,aAAa;AAoBtB,OAAO,IAAMC,YAAY,GAAGF,MAAM,CAAY,UAACG,GAAG;EAAA,OAAM;IACtDC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,IAAI;IACXC,eAAe,EAAE,KAAK;IACtBC,SAAS,EAAE,IAAI;IAEfC,KAAK;MAAA,IAAAC,MAAA,GAAAC,iBAAA,CAAE,WAAOL,KAAK,EAAED,IAAI,EAAK;QAC5B,MAAMH,aAAa,CAACU,OAAO,CAAC,cAAc,EAAEN,KAAK,CAAC;QAClD,MAAMJ,aAAa,CAACU,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACT,IAAI,CAAC,CAAC;QACzDD,GAAG,CAAC;UAAEE,KAAK,EAALA,KAAK;UAAED,IAAI,EAAJA,IAAI;UAAEE,eAAe,EAAE;QAAK,CAAC,CAAC;MAC7C,CAAC;MAAA,SAJDE,KAAKA,CAAAM,EAAA,EAAAC,GAAA;QAAA,OAAAN,MAAA,CAAAO,KAAA,OAAAC,SAAA;MAAA;MAAA,OAALT,KAAK;IAAA,GAIJ;IAEDU,MAAM;MAAA,IAAAC,OAAA,GAAAT,iBAAA,CAAE,aAAY;QAClB,MAAMT,aAAa,CAACmB,UAAU,CAAC,cAAc,CAAC;QAC9C,MAAMnB,aAAa,CAACmB,UAAU,CAAC,MAAM,CAAC;QACtCjB,GAAG,CAAC;UAAEE,KAAK,EAAE,IAAI;UAAED,IAAI,EAAE,IAAI;UAAEE,eAAe,EAAE;QAAM,CAAC,CAAC;MAC1D,CAAC;MAAA,SAJDY,MAAMA,CAAA;QAAA,OAAAC,OAAA,CAAAH,KAAA,OAAAC,SAAA;MAAA;MAAA,OAANC,MAAM;IAAA,GAIL;IAEDG,YAAY;MAAA,IAAAC,aAAA,GAAAZ,iBAAA,CAAE,aAAY;QACxB,IAAI;UACF,IAAML,KAAK,SAASJ,aAAa,CAACsB,OAAO,CAAC,cAAc,CAAC;UACzD,IAAMC,OAAO,SAASvB,aAAa,CAACsB,OAAO,CAAC,MAAM,CAAC;UAEnD,IAAIlB,KAAK,IAAImB,OAAO,EAAE;YACpB,IAAMpB,IAAI,GAAGQ,IAAI,CAACa,KAAK,CAACD,OAAO,CAAC;YAChCrB,GAAG,CAAC;cAAEE,KAAK,EAALA,KAAK;cAAED,IAAI,EAAJA,IAAI;cAAEE,eAAe,EAAE,IAAI;cAAEC,SAAS,EAAE;YAAM,CAAC,CAAC;UAC/D,CAAC,MAAM;YACLJ,GAAG,CAAC;cAAEI,SAAS,EAAE;YAAM,CAAC,CAAC;UAC3B;QACF,CAAC,CAAC,OAAOmB,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;UAChDvB,GAAG,CAAC;YAAEI,SAAS,EAAE;UAAM,CAAC,CAAC;QAC3B;MACF,CAAC;MAAA,SAfDc,YAAYA,CAAA;QAAA,OAAAC,aAAA,CAAAN,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAZI,YAAY;IAAA;EAgBd,CAAC;AAAA,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
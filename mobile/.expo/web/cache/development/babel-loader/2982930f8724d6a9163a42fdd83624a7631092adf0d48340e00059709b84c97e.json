{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, createElement } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Text from \"react-native-paper/lib/module/components/Typography/Text\";\nimport Button from \"react-native-paper/lib/module/components/Button/Button\";\nimport TextInput from \"react-native-paper/lib/module/components/TextInput/TextInput\";\nimport { useTheme } from \"react-native-paper/lib/module/core/theming\";\nimport Menu from \"react-native-paper/lib/module/components/Menu/Menu\";\nimport TouchableRipple from \"react-native-paper/lib/module/components/TouchableRipple/TouchableRipple\";\nimport HelperText from \"react-native-paper/lib/module/components/HelperText/HelperText\";\nimport ProgressBar from \"react-native-paper/lib/module/components/ProgressBar\";\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport DateTimePicker from '@react-native-community/datetimepicker';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport { appointmentService } from \"../services/appointment.service\";\nimport dayjs from 'dayjs';\nimport { useNavigation } from '@react-navigation/native';\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function BookingScreen() {\n  var theme = useTheme();\n  var navigation = useNavigation();\n  var queryClient = useQueryClient();\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    selectedBranch = _useState2[0],\n    setSelectedBranch = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    selectedSpecialty = _useState4[0],\n    setSelectedSpecialty = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    selectedDoctor = _useState6[0],\n    setSelectedDoctor = _useState6[1];\n  var _useState7 = useState(new Date()),\n    _useState8 = _slicedToArray(_useState7, 2),\n    date = _useState8[0],\n    setDate = _useState8[1];\n  var _useState9 = useState(false),\n    _useState0 = _slicedToArray(_useState9, 2),\n    showDatePicker = _useState0[0],\n    setShowDatePicker = _useState0[1];\n  var _useState1 = useState(''),\n    _useState10 = _slicedToArray(_useState1, 2),\n    notes = _useState10[0],\n    setNotes = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    menuBranchVisible = _useState12[0],\n    setMenuBranchVisible = _useState12[1];\n  var _useState13 = useState(false),\n    _useState14 = _slicedToArray(_useState13, 2),\n    menuSpecialtyVisible = _useState14[0],\n    setMenuSpecialtyVisible = _useState14[1];\n  var _useState15 = useState(false),\n    _useState16 = _slicedToArray(_useState15, 2),\n    menuDoctorVisible = _useState16[0],\n    setMenuDoctorVisible = _useState16[1];\n  var _useQuery = useQuery({\n      queryKey: ['branches'],\n      queryFn: appointmentService.getBranches,\n      onError: function onError() {\n        return console.log('Lỗi tải danh sách chi nhánh');\n      }\n    }),\n    _useQuery$data = _useQuery.data,\n    branches = _useQuery$data === void 0 ? [] : _useQuery$data;\n  var _useQuery2 = useQuery({\n      queryKey: ['specialties'],\n      queryFn: appointmentService.getSpecialties,\n      onError: function onError() {\n        return console.log('Lỗi tải danh sách chuyên khoa');\n      }\n    }),\n    _useQuery2$data = _useQuery2.data,\n    specialties = _useQuery2$data === void 0 ? [] : _useQuery2$data;\n  var _useQuery3 = useQuery({\n      queryKey: ['doctors', selectedBranch, selectedSpecialty],\n      queryFn: function queryFn() {\n        return appointmentService.getDoctors(selectedBranch, selectedSpecialty);\n      },\n      enabled: !!selectedBranch,\n      onError: function onError() {\n        return console.log('Lỗi tải danh sách bác sĩ');\n      }\n    }),\n    _useQuery3$data = _useQuery3.data,\n    doctors = _useQuery3$data === void 0 ? [] : _useQuery3$data,\n    loadingDoctors = _useQuery3.isFetching;\n  var createMutation = useMutation({\n    mutationFn: appointmentService.createAppointment,\n    onSuccess: function onSuccess() {\n      Alert.alert('Thành công', 'Đặt lịch khám thành công!');\n      queryClient.invalidateQueries(['myAppointments']);\n      navigation.navigate('Appointments');\n    },\n    onError: function onError(err) {\n      var _err$response, _err$response$data;\n      var message = (err == null ? void 0 : (_err$response = err.response) == null ? void 0 : (_err$response$data = _err$response.data) == null ? void 0 : _err$response$data.message) || 'Có lỗi xảy ra, vui lòng thử lại';\n      Alert.alert('Lỗi đặt lịch', message);\n    }\n  });\n  var handleDateChange = function handleDateChange(event, selectedDate) {\n    setShowDatePicker(Platform.OS === 'ios');\n    if (selectedDate) setDate(selectedDate);\n  };\n  var handleSubmit = function handleSubmit() {\n    if (!selectedBranch) {\n      Alert.alert('Thiếu thông tin', 'Vui lòng chọn cơ sở khám');\n      return;\n    }\n    if (!notes.trim()) {\n      Alert.alert('Thiếu thông tin', 'Vui lòng nhập triệu chứng/lý do khám');\n      return;\n    }\n    createMutation.mutate({\n      branch_id: selectedBranch,\n      doctor_id: selectedDoctor || undefined,\n      start_time: date.toISOString(),\n      notes: notes\n    });\n  };\n  var getBranchName = function getBranchName() {\n    var _branches$find;\n    return Array.isArray(branches) ? ((_branches$find = branches.find(function (b) {\n      return b.id === selectedBranch;\n    })) == null ? void 0 : _branches$find.name) || 'Chọn chi nhánh' : 'Chọn chi nhánh';\n  };\n  var getSpecialtyName = function getSpecialtyName() {\n    var _specialties$find;\n    return Array.isArray(specialties) ? ((_specialties$find = specialties.find(function (s) {\n      return s.id === selectedSpecialty;\n    })) == null ? void 0 : _specialties$find.name) || 'Tất cả chuyên khoa' : 'Tất cả chuyên khoa';\n  };\n  var getDoctorName = function getDoctorName() {\n    var _doctors$find, _doctors$find$user;\n    return Array.isArray(doctors) ? ((_doctors$find = doctors.find(function (d) {\n      return d.id === selectedDoctor;\n    })) == null ? void 0 : (_doctors$find$user = _doctors$find.user) == null ? void 0 : _doctors$find$user.full_name) || 'Chọn bác sĩ (hoặc để trống)' : 'Chọn bác sĩ';\n  };\n  return _jsx(KeyboardAvoidingView, {\n    behavior: Platform.OS === 'ios' ? 'padding' : undefined,\n    style: {\n      flex: 1\n    },\n    children: _jsxs(ScrollView, {\n      style: styles.container,\n      contentContainerStyle: {\n        paddingBottom: 40\n      },\n      children: [_jsxs(View, {\n        style: styles.stepContainer,\n        children: [_jsx(Text, {\n          variant: \"titleMedium\",\n          style: {\n            fontWeight: 'bold',\n            color: theme.colors.primary\n          },\n          children: \"1. Th\\xF4ng tin kh\\xE1m\"\n        }), _jsx(ProgressBar, {\n          progress: 0.5,\n          color: theme.colors.primary,\n          style: {\n            marginTop: 8,\n            borderRadius: 4\n          }\n        })]\n      }), _jsxs(View, {\n        style: styles.formContainer,\n        children: [_jsxs(View, {\n          style: styles.inputGroup,\n          children: [_jsxs(Text, {\n            style: styles.label,\n            children: [\"C\\u01A1 s\\u1EDF kh\\xE1m \", _jsx(Text, {\n              style: {\n                color: 'red'\n              },\n              children: \"*\"\n            })]\n          }), _jsx(Menu, {\n            visible: menuBranchVisible,\n            onDismiss: function onDismiss() {\n              return setMenuBranchVisible(false);\n            },\n            anchor: _jsx(TouchableRipple, {\n              onPress: function onPress() {\n                return setMenuBranchVisible(true);\n              },\n              style: styles.dropdown,\n              children: _jsxs(View, {\n                style: styles.dropdownContent,\n                children: [_jsx(Text, {\n                  style: {\n                    color: selectedBranch ? 'black' : '#777'\n                  },\n                  children: getBranchName()\n                }), _jsx(MaterialCommunityIcons, {\n                  name: \"chevron-down\",\n                  size: 24,\n                  color: \"#777\"\n                })]\n              })\n            }),\n            children: Array.isArray(branches) && branches.map(function (branch) {\n              return _jsx(Menu.Item, {\n                onPress: function onPress() {\n                  setSelectedBranch(branch.id);\n                  setMenuBranchVisible(false);\n                },\n                title: branch.name\n              }, branch.id);\n            })\n          })]\n        }), _jsxs(View, {\n          style: styles.inputGroup,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"Chuy\\xEAn khoa (L\\u1ECDc b\\xE1c s\\u0129)\"\n          }), _jsxs(Menu, {\n            visible: menuSpecialtyVisible,\n            onDismiss: function onDismiss() {\n              return setMenuSpecialtyVisible(false);\n            },\n            anchor: _jsx(TouchableRipple, {\n              onPress: function onPress() {\n                return setMenuSpecialtyVisible(true);\n              },\n              style: styles.dropdown,\n              children: _jsxs(View, {\n                style: styles.dropdownContent,\n                children: [_jsx(Text, {\n                  style: {\n                    color: selectedSpecialty ? 'black' : '#777'\n                  },\n                  children: getSpecialtyName()\n                }), _jsx(MaterialCommunityIcons, {\n                  name: \"chevron-down\",\n                  size: 24,\n                  color: \"#777\"\n                })]\n              })\n            }),\n            children: [_jsx(Menu.Item, {\n              onPress: function onPress() {\n                setSelectedSpecialty('');\n                setMenuSpecialtyVisible(false);\n              },\n              title: \"T\\u1EA5t c\\u1EA3 chuy\\xEAn khoa\"\n            }), Array.isArray(specialties) && specialties.map(function (spec) {\n              return _jsx(Menu.Item, {\n                onPress: function onPress() {\n                  setSelectedSpecialty(spec.id);\n                  setMenuSpecialtyVisible(false);\n                },\n                title: spec.name\n              }, spec.id);\n            })]\n          })]\n        }), _jsxs(View, {\n          style: styles.inputGroup,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"B\\xE1c s\\u0129 kh\\xE1m\"\n          }), _jsxs(Menu, {\n            visible: menuDoctorVisible,\n            onDismiss: function onDismiss() {\n              return setMenuDoctorVisible(false);\n            },\n            anchor: _jsx(TouchableRipple, {\n              onPress: function onPress() {\n                return !selectedBranch ? Alert.alert('Lưu ý', 'Vui lòng chọn cơ sở trước') : setMenuDoctorVisible(true);\n              },\n              style: [styles.dropdown, !selectedBranch && {\n                backgroundColor: '#f0f0f0'\n              }],\n              children: _jsxs(View, {\n                style: styles.dropdownContent,\n                children: [_jsx(Text, {\n                  style: {\n                    color: selectedDoctor ? 'black' : '#777'\n                  },\n                  children: loadingDoctors ? 'Đang tải...' : getDoctorName()\n                }), _jsx(MaterialCommunityIcons, {\n                  name: \"chevron-down\",\n                  size: 24,\n                  color: \"#777\"\n                })]\n              })\n            }),\n            children: [_jsx(Menu.Item, {\n              onPress: function onPress() {\n                setSelectedDoctor('');\n                setMenuDoctorVisible(false);\n              },\n              title: \"Ch\\u1ECDn b\\xE1c s\\u0129 ng\\u1EABu nhi\\xEAn\"\n            }), Array.isArray(doctors) && doctors.map(function (doc) {\n              var _doc$user;\n              return _jsx(Menu.Item, {\n                onPress: function onPress() {\n                  setSelectedDoctor(doc.id);\n                  setMenuDoctorVisible(false);\n                },\n                title: ((_doc$user = doc.user) == null ? void 0 : _doc$user.full_name) || 'Bác sĩ (Không tên)'\n              }, doc.id);\n            })]\n          }), !selectedBranch && _jsx(HelperText, {\n            type: \"info\",\n            children: \"Vui l\\xF2ng ch\\u1ECDn c\\u01A1 s\\u1EDF \\u0111\\u1EC3 xem danh s\\xE1ch b\\xE1c s\\u0129\"\n          })]\n        }), _jsxs(View, {\n          style: styles.inputGroup,\n          children: [_jsxs(Text, {\n            style: styles.label,\n            children: [\"Ng\\xE0y kh\\xE1m \", _jsx(Text, {\n              style: {\n                color: 'red'\n              },\n              children: \"*\"\n            })]\n          }), Platform.OS === 'web' ? _jsx(View, {\n            style: styles.dropdown,\n            children: createElement('input', {\n              type: 'datetime-local',\n              value: dayjs(date).format('YYYY-MM-DDTHH:mm'),\n              style: {\n                border: 'none',\n                outline: 'none',\n                width: '100%',\n                fontSize: 16,\n                fontFamily: 'System',\n                backgroundColor: 'transparent'\n              },\n              onChange: function onChange(e) {\n                return setDate(new Date(e.target.value));\n              }\n            })\n          }) : _jsxs(_Fragment, {\n            children: [_jsx(TouchableRipple, {\n              onPress: function onPress() {\n                return setShowDatePicker(true);\n              },\n              style: styles.dropdown,\n              children: _jsxs(View, {\n                style: styles.dropdownContent,\n                children: [_jsx(Text, {\n                  children: dayjs(date).format('DD/MM/YYYY HH:mm')\n                }), _jsx(MaterialCommunityIcons, {\n                  name: \"calendar\",\n                  size: 24,\n                  color: \"#777\"\n                })]\n              })\n            }), showDatePicker && _jsx(DateTimePicker, {\n              value: date,\n              mode: \"date\",\n              display: Platform.OS === 'ios' ? 'spinner' : 'default',\n              onChange: handleDateChange,\n              minimumDate: new Date()\n            })]\n          })]\n        }), _jsxs(View, {\n          style: styles.inputGroup,\n          children: [_jsxs(Text, {\n            style: styles.label,\n            children: [\"Tri\\u1EC7u ch\\u1EE9ng / L\\xFD do \", _jsx(Text, {\n              style: {\n                color: 'red'\n              },\n              children: \"*\"\n            })]\n          }), _jsx(TextInput, {\n            mode: \"outlined\",\n            placeholder: \"Nh\\u1EADp tri\\u1EC7u ch\\u1EE9ng (VD: \\u0110au \\u0111\\u1EA7u, s\\u1ED1t...)\",\n            multiline: true,\n            numberOfLines: 4,\n            value: notes,\n            onChangeText: setNotes,\n            style: {\n              backgroundColor: 'white'\n            }\n          })]\n        }), _jsxs(View, {\n          style: styles.buttonRow,\n          children: [_jsx(Button, {\n            mode: \"outlined\",\n            onPress: function onPress() {\n              return navigation.goBack();\n            },\n            style: {\n              flex: 1\n            },\n            children: \"Quay l\\u1EA1i\"\n          }), _jsx(View, {\n            style: {\n              width: 12\n            }\n          }), _jsx(Button, {\n            mode: \"contained\",\n            onPress: handleSubmit,\n            loading: createMutation.isPending,\n            style: {\n              flex: 1\n            },\n            children: \"Ti\\u1EBFp t\\u1EE5c\"\n          })]\n        })]\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff'\n  },\n  stepContainer: {\n    padding: 16,\n    backgroundColor: '#f9f9f9',\n    borderBottomWidth: 1,\n    borderBottomColor: '#eee'\n  },\n  formContainer: {\n    padding: 16\n  },\n  inputGroup: {\n    marginBottom: 20\n  },\n  label: {\n    marginBottom: 8,\n    fontWeight: '500',\n    color: '#333'\n  },\n  dropdown: {\n    borderWidth: 1,\n    borderColor: '#ccc',\n    borderRadius: 4,\n    padding: 14,\n    backgroundColor: 'white',\n    height: 56,\n    justifyContent: 'center'\n  },\n  dropdownContent: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  buttonRow: {\n    flexDirection: 'row',\n    marginTop: 10,\n    marginBottom: 20\n  }\n});","map":{"version":3,"names":["React","useState","createElement","View","StyleSheet","ScrollView","Platform","KeyboardAvoidingView","Alert","Text","Button","TextInput","useTheme","Menu","TouchableRipple","HelperText","ProgressBar","useQuery","useMutation","useQueryClient","DateTimePicker","MaterialCommunityIcons","appointmentService","dayjs","useNavigation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","BookingScreen","theme","navigation","queryClient","_useState","_useState2","_slicedToArray","selectedBranch","setSelectedBranch","_useState3","_useState4","selectedSpecialty","setSelectedSpecialty","_useState5","_useState6","selectedDoctor","setSelectedDoctor","_useState7","Date","_useState8","date","setDate","_useState9","_useState0","showDatePicker","setShowDatePicker","_useState1","_useState10","notes","setNotes","_useState11","_useState12","menuBranchVisible","setMenuBranchVisible","_useState13","_useState14","menuSpecialtyVisible","setMenuSpecialtyVisible","_useState15","_useState16","menuDoctorVisible","setMenuDoctorVisible","_useQuery","queryKey","queryFn","getBranches","onError","console","log","_useQuery$data","data","branches","_useQuery2","getSpecialties","_useQuery2$data","specialties","_useQuery3","getDoctors","enabled","_useQuery3$data","doctors","loadingDoctors","isFetching","createMutation","mutationFn","createAppointment","onSuccess","alert","invalidateQueries","navigate","err","_err$response","_err$response$data","message","response","handleDateChange","event","selectedDate","OS","handleSubmit","trim","mutate","branch_id","doctor_id","undefined","start_time","toISOString","getBranchName","_branches$find","Array","isArray","find","b","id","name","getSpecialtyName","_specialties$find","s","getDoctorName","_doctors$find","_doctors$find$user","d","user","full_name","behavior","style","flex","children","styles","container","contentContainerStyle","paddingBottom","stepContainer","variant","fontWeight","color","colors","primary","progress","marginTop","borderRadius","formContainer","inputGroup","label","visible","onDismiss","anchor","onPress","dropdown","dropdownContent","size","map","branch","Item","title","spec","backgroundColor","doc","_doc$user","type","value","format","border","outline","width","fontSize","fontFamily","onChange","e","target","mode","display","minimumDate","placeholder","multiline","numberOfLines","onChangeText","buttonRow","goBack","loading","isPending","create","padding","borderBottomWidth","borderBottomColor","marginBottom","borderWidth","borderColor","height","justifyContent","flexDirection","alignItems"],"sources":["D:/Student/N4_HK2/Web_App/clinic-starter/mobile/src/screens/BookingScreen.tsx"],"sourcesContent":["import React, { useState, createElement } from 'react';\r\nimport { View, StyleSheet, ScrollView, Platform, KeyboardAvoidingView, Alert } from 'react-native';\r\nimport { Text, Button, TextInput, useTheme, Menu, TouchableRipple, HelperText, ProgressBar } from 'react-native-paper';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { appointmentService } from '../services/appointment.service';\r\nimport dayjs from 'dayjs';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nexport default function BookingScreen() {\r\n    const theme = useTheme();\r\n    const navigation = useNavigation<any>();\r\n    const queryClient = useQueryClient();\r\n\r\n    // --- FORM STATE ---\r\n    const [selectedBranch, setSelectedBranch] = useState<string>('');\r\n    const [selectedSpecialty, setSelectedSpecialty] = useState<string>('');\r\n    const [selectedDoctor, setSelectedDoctor] = useState<string>('');\r\n    const [date, setDate] = useState(new Date());\r\n    const [showDatePicker, setShowDatePicker] = useState(false);\r\n    const [notes, setNotes] = useState('');\r\n\r\n    // --- UI STATE (Dropdown Menus) ---\r\n    const [menuBranchVisible, setMenuBranchVisible] = useState(false);\r\n    const [menuSpecialtyVisible, setMenuSpecialtyVisible] = useState(false);\r\n    const [menuDoctorVisible, setMenuDoctorVisible] = useState(false);\r\n\r\n    // --- DATA FETCHING ---\r\n    // Dùng fallback [] để tránh crash nếu API lỗi\r\n    const { data: branches = [] } = useQuery({\r\n        queryKey: ['branches'],\r\n        queryFn: appointmentService.getBranches,\r\n        onError: () => console.log('Lỗi tải danh sách chi nhánh')\r\n    });\r\n\r\n    const { data: specialties = [] } = useQuery({\r\n        queryKey: ['specialties'],\r\n        queryFn: appointmentService.getSpecialties,\r\n        onError: () => console.log('Lỗi tải danh sách chuyên khoa')\r\n    });\r\n\r\n    // Fetch doctors based on filters\r\n    const { data: doctors = [], isFetching: loadingDoctors } = useQuery({\r\n        queryKey: ['doctors', selectedBranch, selectedSpecialty],\r\n        queryFn: () => appointmentService.getDoctors(selectedBranch, selectedSpecialty),\r\n        enabled: !!selectedBranch,\r\n        onError: () => console.log('Lỗi tải danh sách bác sĩ')\r\n    });\r\n\r\n    // --- MUTATION (Gửi đặt lịch) ---\r\n    const createMutation = useMutation({\r\n        mutationFn: appointmentService.createAppointment,\r\n        onSuccess: () => {\r\n            Alert.alert('Thành công', 'Đặt lịch khám thành công!');\r\n            queryClient.invalidateQueries(['myAppointments']);\r\n            navigation.navigate('Appointments');\r\n        },\r\n        onError: (err: any) => {\r\n            // Hiển thị thông báo lỗi rõ ràng hơn\r\n            const message = err?.response?.data?.message || 'Có lỗi xảy ra, vui lòng thử lại';\r\n            Alert.alert('Lỗi đặt lịch', message);\r\n        },\r\n    });\r\n\r\n    // --- HANDLERS ---\r\n    const handleDateChange = (event: any, selectedDate?: Date) => {\r\n        setShowDatePicker(Platform.OS === 'ios');\r\n        if (selectedDate) setDate(selectedDate);\r\n    };\r\n\r\n    const handleSubmit = () => {\r\n        if (!selectedBranch) {\r\n            Alert.alert('Thiếu thông tin', 'Vui lòng chọn cơ sở khám');\r\n            return;\r\n        }\r\n        if (!notes.trim()) {\r\n            Alert.alert('Thiếu thông tin', 'Vui lòng nhập triệu chứng/lý do khám');\r\n            return;\r\n        }\r\n\r\n        createMutation.mutate({\r\n            branch_id: selectedBranch,\r\n            doctor_id: selectedDoctor || undefined,\r\n            start_time: date.toISOString(),\r\n            notes: notes,\r\n        });\r\n    };\r\n\r\n    // Helper hiển thị tên an toàn\r\n    const getBranchName = () => Array.isArray(branches) ? branches.find((b) => b.id === selectedBranch)?.name || 'Chọn chi nhánh' : 'Chọn chi nhánh';\r\n    const getSpecialtyName = () => Array.isArray(specialties) ? specialties.find((s) => s.id === selectedSpecialty)?.name || 'Tất cả chuyên khoa' : 'Tất cả chuyên khoa';\r\n    const getDoctorName = () => Array.isArray(doctors) ? doctors.find((d) => d.id === selectedDoctor)?.user?.full_name || 'Chọn bác sĩ (hoặc để trống)' : 'Chọn bác sĩ';\r\n\r\n    return (\r\n        <KeyboardAvoidingView behavior={Platform.OS === 'ios' ? 'padding' : undefined} style={{ flex: 1 }}>\r\n            <ScrollView style={styles.container} contentContainerStyle={{ paddingBottom: 40 }}>\r\n\r\n                {/* STEP INDICATOR */}\r\n                <View style={styles.stepContainer}>\r\n                    <Text variant=\"titleMedium\" style={{ fontWeight: 'bold', color: theme.colors.primary }}>\r\n                        1. Thông tin khám\r\n                    </Text>\r\n                    <ProgressBar progress={0.5} color={theme.colors.primary} style={{ marginTop: 8, borderRadius: 4 }} />\r\n                </View>\r\n\r\n                <View style={styles.formContainer}>\r\n                    {/* 1. CHỌN CƠ SỞ (Bắt buộc) */}\r\n                    <View style={styles.inputGroup}>\r\n                        <Text style={styles.label}>Cơ sở khám <Text style={{ color: 'red' }}>*</Text></Text>\r\n                        <Menu\r\n                            visible={menuBranchVisible}\r\n                            onDismiss={() => setMenuBranchVisible(false)}\r\n                            anchor={\r\n                                <TouchableRipple onPress={() => setMenuBranchVisible(true)} style={styles.dropdown}>\r\n                                    <View style={styles.dropdownContent}>\r\n                                        <Text style={{ color: selectedBranch ? 'black' : '#777' }}>{getBranchName()}</Text>\r\n                                        <MaterialCommunityIcons name=\"chevron-down\" size={24} color=\"#777\" />\r\n                                    </View>\r\n                                </TouchableRipple>\r\n                            }\r\n                        >\r\n                            {/* Kiểm tra mảng trước khi map để tránh lỗi */}\r\n                            {Array.isArray(branches) && branches.map((branch) => (\r\n                                <Menu.Item\r\n                                    key={branch.id}\r\n                                    onPress={() => { setSelectedBranch(branch.id); setMenuBranchVisible(false); }}\r\n                                    title={branch.name}\r\n                                />\r\n                            ))}\r\n                        </Menu>\r\n                    </View>\r\n\r\n                    {/* 2. CHỌN CHUYÊN KHOA (Lọc) */}\r\n                    <View style={styles.inputGroup}>\r\n                        <Text style={styles.label}>Chuyên khoa (Lọc bác sĩ)</Text>\r\n                        <Menu\r\n                            visible={menuSpecialtyVisible}\r\n                            onDismiss={() => setMenuSpecialtyVisible(false)}\r\n                            anchor={\r\n                                <TouchableRipple onPress={() => setMenuSpecialtyVisible(true)} style={styles.dropdown}>\r\n                                    <View style={styles.dropdownContent}>\r\n                                        <Text style={{ color: selectedSpecialty ? 'black' : '#777' }}>{getSpecialtyName()}</Text>\r\n                                        <MaterialCommunityIcons name=\"chevron-down\" size={24} color=\"#777\" />\r\n                                    </View>\r\n                                </TouchableRipple>\r\n                            }\r\n                        >\r\n                            <Menu.Item onPress={() => { setSelectedSpecialty(''); setMenuSpecialtyVisible(false); }} title=\"Tất cả chuyên khoa\" />\r\n                            {/* Sửa lỗi crash khi specialties bị null/undefined */}\r\n                            {Array.isArray(specialties) && specialties.map((spec) => (\r\n                                <Menu.Item\r\n                                    key={spec.id}\r\n                                    onPress={() => { setSelectedSpecialty(spec.id); setMenuSpecialtyVisible(false); }}\r\n                                    title={spec.name}\r\n                                />\r\n                            ))}\r\n                        </Menu>\r\n                    </View>\r\n\r\n                    {/* 3. CHỌN BÁC SĨ (Phụ thuộc Cơ sở) */}\r\n                    <View style={styles.inputGroup}>\r\n                        <Text style={styles.label}>Bác sĩ khám</Text>\r\n                        <Menu\r\n                            visible={menuDoctorVisible}\r\n                            onDismiss={() => setMenuDoctorVisible(false)}\r\n                            anchor={\r\n                                <TouchableRipple\r\n                                    onPress={() => !selectedBranch ? Alert.alert('Lưu ý', 'Vui lòng chọn cơ sở trước') : setMenuDoctorVisible(true)}\r\n                                    style={[styles.dropdown, !selectedBranch && { backgroundColor: '#f0f0f0' }]}\r\n                                >\r\n                                    <View style={styles.dropdownContent}>\r\n                                        <Text style={{ color: selectedDoctor ? 'black' : '#777' }}>\r\n                                            {loadingDoctors ? 'Đang tải...' : getDoctorName()}\r\n                                        </Text>\r\n                                        <MaterialCommunityIcons name=\"chevron-down\" size={24} color=\"#777\" />\r\n                                    </View>\r\n                                </TouchableRipple>\r\n                            }\r\n                        >\r\n                            <Menu.Item onPress={() => { setSelectedDoctor(''); setMenuDoctorVisible(false); }} title=\"Chọn bác sĩ ngẫu nhiên\" />\r\n                            {/* Sửa lỗi crash khi doctors bị null/undefined */}\r\n                            {Array.isArray(doctors) && doctors.map((doc) => (\r\n                                <Menu.Item\r\n                                    key={doc.id}\r\n                                    onPress={() => { setSelectedDoctor(doc.id); setMenuDoctorVisible(false); }}\r\n                                    title={doc.user?.full_name || 'Bác sĩ (Không tên)'}\r\n                                />\r\n                            ))}\r\n                        </Menu>\r\n                        {!selectedBranch && <HelperText type=\"info\">Vui lòng chọn cơ sở để xem danh sách bác sĩ</HelperText>}\r\n                    </View>\r\n\r\n                    {/* 4. CHỌN NGÀY GIỜ (Fix lỗi Web) */}\r\n                    <View style={styles.inputGroup}>\r\n                        <Text style={styles.label}>Ngày khám <Text style={{ color: 'red' }}>*</Text></Text>\r\n\r\n                        {Platform.OS === 'web' ? (\r\n                            // Giao diện riêng cho WEB: Dùng thẻ input HTML chuẩn\r\n                            <View style={styles.dropdown}>\r\n                                {createElement('input', {\r\n                                    type: 'datetime-local',\r\n                                    value: dayjs(date).format('YYYY-MM-DDTHH:mm'),\r\n                                    style: {\r\n                                        border: 'none',\r\n                                        outline: 'none',\r\n                                        width: '100%',\r\n                                        fontSize: 16,\r\n                                        fontFamily: 'System',\r\n                                        backgroundColor: 'transparent'\r\n                                    },\r\n                                    onChange: (e: any) => setDate(new Date(e.target.value))\r\n                                })}\r\n                            </View>\r\n                        ) : (\r\n                            // Giao diện cho MOBILE (Android/iOS)\r\n                            <>\r\n                                <TouchableRipple onPress={() => setShowDatePicker(true)} style={styles.dropdown}>\r\n                                    <View style={styles.dropdownContent}>\r\n                                        <Text>{dayjs(date).format('DD/MM/YYYY HH:mm')}</Text>\r\n                                        <MaterialCommunityIcons name=\"calendar\" size={24} color=\"#777\" />\r\n                                    </View>\r\n                                </TouchableRipple>\r\n                                {showDatePicker && (\r\n                                    <DateTimePicker\r\n                                        value={date}\r\n                                        mode=\"date\"\r\n                                        display={Platform.OS === 'ios' ? 'spinner' : 'default'}\r\n                                        onChange={handleDateChange}\r\n                                        minimumDate={new Date()}\r\n                                    />\r\n                                )}\r\n                            </>\r\n                        )}\r\n                    </View>\r\n\r\n                    {/* 5. TRIỆU CHỨNG / LÝ DO */}\r\n                    <View style={styles.inputGroup}>\r\n                        <Text style={styles.label}>Triệu chứng / Lý do <Text style={{ color: 'red' }}>*</Text></Text>\r\n                        <TextInput\r\n                            mode=\"outlined\"\r\n                            placeholder=\"Nhập triệu chứng (VD: Đau đầu, sốt...)\"\r\n                            multiline\r\n                            numberOfLines={4}\r\n                            value={notes}\r\n                            onChangeText={setNotes}\r\n                            style={{ backgroundColor: 'white' }}\r\n                        />\r\n                    </View>\r\n\r\n                    {/* BUTTONS */}\r\n                    <View style={styles.buttonRow}>\r\n                        <Button mode=\"outlined\" onPress={() => navigation.goBack()} style={{ flex: 1 }}>\r\n                            Quay lại\r\n                        </Button>\r\n                        <View style={{ width: 12 }} />\r\n                        <Button\r\n                            mode=\"contained\"\r\n                            onPress={handleSubmit}\r\n                            loading={createMutation.isPending}\r\n                            style={{ flex: 1 }}\r\n                        >\r\n                            Tiếp tục\r\n                        </Button>\r\n                    </View>\r\n\r\n                </View>\r\n            </ScrollView>\r\n        </KeyboardAvoidingView>\r\n    );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n    },\r\n    stepContainer: {\r\n        padding: 16,\r\n        backgroundColor: '#f9f9f9',\r\n        borderBottomWidth: 1,\r\n        borderBottomColor: '#eee',\r\n    },\r\n    formContainer: {\r\n        padding: 16,\r\n    },\r\n    inputGroup: {\r\n        marginBottom: 20,\r\n    },\r\n    label: {\r\n        marginBottom: 8,\r\n        fontWeight: '500',\r\n        color: '#333',\r\n    },\r\n    dropdown: {\r\n        borderWidth: 1,\r\n        borderColor: '#ccc',\r\n        borderRadius: 4,\r\n        padding: 14,\r\n        backgroundColor: 'white',\r\n        height: 56, // Cố định chiều cao để đồng bộ\r\n        justifyContent: 'center',\r\n    },\r\n    dropdownContent: {\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n    },\r\n    buttonRow: {\r\n        flexDirection: 'row',\r\n        marginTop: 10,\r\n        marginBottom: 20,\r\n    },\r\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}